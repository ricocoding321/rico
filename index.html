<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copilot Said: Simon Game</title>
    <style>
        body {
            color: #eee;
            font-family: system-ui, sans-serif;
            margin: 0;
            background-image:
                repeating-linear-gradient(to right, #2d2a44 0 1px, transparent 2px 200px),
                repeating-linear-gradient(to bottom, #2d2a44 0 1px, transparent 2px 200px),
                radial-gradient(at 50% 50%, #2d2a44, #1d1b34);
        }
        main {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        h1 {
            background-image: linear-gradient(to left, #89a5df, #e46e7f, #e8e191);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 16px;
        }
        .simon-board {
            display: grid;
            grid-template-columns: repeat(2, 110px);
            grid-template-rows: repeat(2, 110px);
            gap: 22px;
            margin-bottom: 30px;
        }
        .simon-btn {
            border: none;
            width: 110px;
            height: 110px;
            border-radius: 22px;
            background-color: #555;
            filter: brightness(0.88);
            transition: filter 0.1s, box-shadow 0.1s;
            box-shadow: 0 5px 25px #0008;
            font-size: 2rem;
        }
        .simon-btn.green { background: #1eed5b; }
        .simon-btn.red   { background: #ea252f; }
        .simon-btn.blue  { background: #4073e9; }
        .simon-btn.yellow{ background: #eee145; color: #373104;}
        .simon-btn.active {
            filter: brightness(1.5);
            box-shadow: 0 0 80px 32px #fff5, 0 5px 25px #0006;
        }
        #startBtn {
            all: unset;
            display: inline-block;
            padding: 12px 32px;
            border-radius: 16px;
            background-color: #c691e6cc;
            color: #191122;
            font-weight: bold;
            box-shadow: 0 3px 20px #0003;
            outline: 2px solid #b7b4ef55;
            cursor: pointer;
            margin-bottom: 20px;
            transition: background .2s;
        }
        #startBtn:hover, #startBtn:focus { background: #fff971e5;}
        .game-status {
            margin-bottom: 10px;
            min-height: 2.2em;
            font-size: 1.15em;
        }
        .score {
            margin-top: 5px;
            font-size: 1.1em;
            color: #e46e7f;
        }
        @media (max-width: 540px) {
            .simon-board, .simon-btn { width: 180px; height: 180px; }
            .simon-btn { font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <main>
        <h1>Copilot said: Simon Game</h1>
        <div class="game-status" id="status"></div>
        <div class="score">Score: <span id="score">0</span></div>
        <button id="startBtn">Start Game</button>
        <div class="simon-board" id="board">
            <button class="simon-btn green"  data-color="green"  tabindex="1"></button>
            <button class="simon-btn red"    data-color="red"    tabindex="2"></button>
            <button class="simon-btn yellow" data-color="yellow" tabindex="3"></button>
            <button class="simon-btn blue"   data-color="blue"   tabindex="4"></button>
        </div>
    </main>
<script>
const colors = ['green', 'red', 'yellow', 'blue'];
const board = document.getElementById('board');
const btns  = [...board.getElementsByClassName('simon-btn')];
const startBtn = document.getElementById('startBtn');
const statusText = document.getElementById('status');
const scoreEl = document.getElementById('score');

let seq = [];
let plyIdx = 0;
let running = false;
let canPlay = false;
let score = 0;

function playSound(color) {
    // Basic beep using AudioContext
    const ctx = window.AudioContext ? new AudioContext() : null;
    if (!ctx) return;
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    let freq = 400;
    switch (color) {
        case 'green': freq = 335; break;
        case 'red': freq = 455; break;
        case 'yellow': freq = 569; break;
        case 'blue': freq = 377; break;
    }
    osc.frequency.value = freq;
    osc.type = "triangle";
    osc.connect(gain);
    gain.connect(ctx.destination);
    gain.gain.setValueAtTime(0.20, ctx.currentTime);
    osc.start();
    osc.stop(ctx.currentTime + 0.18);
    osc.onended = () => ctx.close();
}

function lightBtn(idx, ms = 400) {
    const b = btns[idx];
    b.classList.add('active');
    playSound(colors[idx]);
    setTimeout(() => b.classList.remove('active'), ms);
}

function sleep(ms) { return new Promise(r=>setTimeout(r,ms)); }

async function showSeq() {
    canPlay = false;
    statusText.textContent = 'Watch the pattern...';
    for (let i=0; i<seq.length; ++i) {
        lightBtn(seq[i]);
        await sleep(320);
        await sleep(120);
    }
    statusText.textContent = "Repeat the pattern!";
    canPlay = true;
}

function nextStep() {
    seq.push(Math.floor(Math.random() * 4));
    plyIdx = 0;
    showSeq();
}

function reset() {
    running = false;
    canPlay = false;
    seq = [];
    score = 0;
    scoreEl.textContent = "0";
    plyIdx = 0;
    statusText.textContent = '';
}

function failEffect(idx) {
    btns[idx].classList.add('active');
    statusText.textContent = 'Wrong! Game Over.';
    canPlay = false;
    setTimeout(() => {
        btns[idx].classList.remove('active');
        statusText.textContent += ' Press Start to retry.';
    }, 800);
}

function winEffect() {
    statusText.textContent = "Great! Next round...";
}

btns.forEach((btn, idx) => {
    btn.addEventListener('click', () => {
        if (!canPlay || !running) return;
        playSound(colors[idx]);
        if (idx === seq[plyIdx]) {
            plyIdx++;
            if (plyIdx === seq.length) {
                score = seq.length;
                scoreEl.textContent = String(score);
                canPlay = false;
                setTimeout(()=>{
                    winEffect();
                    setTimeout(nextStep, 700);
                },300);
            }
        } else {
            failEffect(idx);
            running = false;
        }
    });
});

startBtn.addEventListener('click', () => {
    reset();
    running = true;
    nextStep();
});

reset();
</script>
</body>
</html>

        
